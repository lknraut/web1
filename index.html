<!DOCTYPE html>

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- CSS styles integrated here -->
		<style>
			* {
				box-sizing: border-box;
				padding: 0;	
				margin: 0;
				font-family: 'Poppins', sans-serif;
				font-size: 18px;
			}
			body {
				height: 100vh;
				display: flex;
				align-items: center;
				justify-content: center;
			}
			.container {
				width: 500px;
				padding: 30px;
				border: 1px solid #eeeeee;
				border-radius: 10px;
				background-color: #003b5b;
			}
			h4 {
				margin-bottom: 10px;
				font-size: 24px;
				color: white;
			}
			input {
				width: 100%;
				padding: 10px;
				margin-bottom: 10px;
			}
			textarea {
				width: 100%;
				padding: 10px;
			}
			#submit {
				border: none;
				background-color: orangered;
				color: white;
				width: 200px;
				margin-top: 10px;
				border-radius: 5px;
			}
			#submit:hover {
				background-color: #333333;
			}
			#success-message {
            display: none; /* Initially hidden */
            background-color: green;
			color: rgb(255, 255, 255);
			border: none;
			width: 200px;
			margin-top: 10px;
			border-radius: 5px;
      
		</style>
	</head>
		
	<body>
		<div class="container">
			<form method="post" action="https://script.google.com/macros/s/AKfycbwWvNUxbY02-OoGHTMXqVpOGF30HlTma_NrhnQHiCtDCmJKlOgkE3-VEMorSN8mXQd-ZQ/exec" name="contact-form">
				<h4>Visitor Entry</h4>
				<label style="color: white;" for="date">Select a date: </label>
				<input type="date" id="date" name="date">
				<input type="text" name="Name" placeholder="Full Name">
				<input type="text" name="Address" placeholder="Address">
				<input type="text" name="Number" placeholder="Mobile Number">
				<input type="email" name="Email" placeholder="Email">
				<input type="text" name="Assosiation" placeholder="Associated with">
				<textarea name="message" rows="3" placeholder="Remarks"></textarea>
				<input type="submit" value="Submit" id="submit"> <div id="success-message">Form Submitted</div>         		
				<br><br><div id="success-message">Form Submitted</div>
			</form>
			<button type="button" onclick="window.open('https://docs.google.com/spreadsheets/d/1MNCN-hbFZUK0JMHm-mL6QQpEYQXNiOmMPaTIwhgLoqI/edit?usp=sharing', '_blank')">View Entries</button>
			<br>
			<br>
			<button type="button" onclick="window.open('https://sites.google.com/view/radiomgirioffice/quotation', '_blank')">Get Quotation</button>
		</div> 

		<!-- JavaScript code integrated here -->
		<script>
			const scriptURL = 'https://script.google.com/macros/s/AKfycbxyMTs105t1h3odqpUSiJGP1Iwf6Yx8aj28riiA0XOh8_KbLpXJyhwJThx65vk28wH1DA/exec';
			const form = document.forms['contact-form'];
			const successMessage = document.getElementById('success-message');

	form.addEventListener('submit', e => {
	e.preventDefault();  // Prevent the default form submission

	fetch(scriptURL, { method: 'POST', body: new FormData(form) })
		.then(response => {
			if (response.ok) {
				successMessage.style.display = 'block';  // Show the success message
				form.reset();  // Optionally reset the form fields
				setTimeout(() => {
                            successMessage.style.display = 'none';
                        }, 5000);
			} 
			else {
				alert('Failed to submit the form. Please try again.');
			}
		})
		.catch(error => console.error('Error!', error.message));
});
		</script>
	</body>
</html>
